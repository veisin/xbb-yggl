/* 1. 基础布局：固定高度，禁止外层滚动 */
.em-app-container {
    height: 85vh; 
    display: flex; 
    flex-direction: column; 
    overflow: hidden;
    background: #f8fafc; 
    font-family: 'Segoe UI', "Microsoft YaHei", sans-serif;
}

/* 2. 顶部固定头：马卡龙雅致风格 */
.em-fixed-header {
    background: #f0f4f8; /* 马卡龙浅蓝灰 */
    border-bottom: 2px solid #e1e8ed; 
    padding: 12px 25px; 
    flex-shrink: 0;
    z-index: 100;
}
.em-header-main { display: flex; justify-content: space-between; align-items: center; }

.em-brand { display: flex; align-items: center; gap: 12px; color: #4a5568; }
.em-brand i { font-size: 26px; color: #a3bffa; }
.em-title-info h2 { margin: 0; font-size: 18px; letter-spacing: 0.5px; }
.em-stats-chips { font-size: 12px; margin-top: 4px; display: flex; gap: 10px; }
.chip-total { background: #e9d5ff; color: #6b21a8; padding: 2px 10px; border-radius: 12px; font-weight: 600; }
.chip-accom { background: #dcfce7; color: #166534; padding: 2px 10px; border-radius: 12px; font-weight: 600; }

/* 3. 统一按钮规范 */
.em-toolbar { display: flex; gap: 12px; align-items: center; }
.em-btn { 
    padding: 8px 18px; border-radius: 8px; border: 1px solid transparent; 
    cursor: pointer; display: flex; align-items: center; gap: 8px; 
    font-size: 14px; font-weight: 500; transition: all 0.2s ease;
}
.em-btn.primary { background: #818cf8; color: white; box-shadow: 0 2px 4px rgba(129, 140, 248, 0.3); }
.em-btn.primary:hover { background: #6366f1; transform: translateY(-1px); }
.em-btn.secondary { background: white; border-color: #d1d5db; color: #4b5563; }
.em-btn.secondary:hover { background: #f9fafb; border-color: #9ca3af; }

/* 搜索框 */
.em-search-wrapper { position: relative; }
.em-search-wrapper i { position: absolute; left: 12px; top: 10px; color: #9ca3af; }
.em-search-wrapper input { 
    padding: 8px 12px 8px 35px; border: 1px solid #d1d5db; border-radius: 20px; 
    width: 220px; outline: none; transition: 0.3s; font-size: 14px;
}
.em-search-wrapper input:focus { border-color: #818cf8; box-shadow: 0 0 0 3px rgba(129, 140, 248, 0.1); }

/* 4. 表格区域：局部滚动 + 固定头 + 固定操作列 */
.em-content-area { flex: 1; overflow: hidden; padding: 15px; }
.em-table-viewport { 
    height: 100%; width: 100%; overflow: auto; 
    border: 1px solid #e5e7eb; border-radius: 12px; background: white;
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05);
}
#em-master-table { width: 100%; border-collapse: separate; border-spacing: 0; min-width: 2500px; }

#em-master-table th { 
    position: sticky; top: 0; background: #f8fafc; z-index: 20;
    padding: 14px 15px; text-align: left; font-size: 13px; color: #4b5563;
    border-bottom: 2px solid #e2e8f0; cursor: pointer; user-select: none;
    white-space: nowrap;
}
#em-master-table th:hover { background: #edf2f7; }

/* 隔行变色与线条 */
#em-master-table tbody tr:nth-child(even) { background-color: #fafafa; }
#em-master-table tbody tr:hover { background-color: #f1f5f9; }
#em-master-table td { 
    padding: 12px 15px; border-bottom: 1px solid #edf2f7; 
    font-size: 14px; color: #334155; white-space: nowrap; 
}

/* 固定操作列 */
.em-sticky-opt-col {
    position: sticky; right: 0; background: white !important;
    z-index: 15; border-left: 2px solid #e2e8f0; width: 110px;
    text-align: center !important; box-shadow: -4px 0 8px rgba(0,0,0,0.03);
}
#em-master-table th.em-sticky-opt-col { background: #f8fafc !important; z-index: 25; }
#em-master-table tr:nth-child(even) td.em-sticky-opt-col { background: #fafafa !important; }
#em-master-table tr:hover td.em-sticky-opt-col { background: #f1f5f9 !important; }

/* 5. 抽屉（新增/编辑）样式增强 */
.em-mask { 
    position: fixed; 
    inset: 0; 
    /* 修改 1：背景色调淡，让模糊感更明显 */
    background: rgba(255, 255, 255, 0.3); 
    
    /* 修改 2：增加模糊半径，2px 太小几乎看不出来，建议 8px-10px */
    backdrop-filter: blur(10px); 
    -webkit-backdrop-filter: blur(10px); /* 适配 Safari 和旧版 Chrome */
    
    visibility: hidden; 
    opacity: 0; 
    transition: all 0.3s ease; 
    z-index: 1000; 
}
.em-drawer { 
    position: fixed; top: 0; right: -500px; width: 480px; height: 100%; 
    background: white; z-index: 1001; transition: 0.4s cubic-bezier(0.16, 1, 0.3, 1); 
    display: flex; flex-direction: column; box-shadow: -10px 0 25px rgba(0,0,0,0.1);
}
.em-drawer.active { right: 0; }
.em-mask.active { 
    visibility: visible; 
    opacity: 1; 
    /* 配合一个深浅过渡，效果更高级 */
    background: rgba(0, 0, 0, 0.2); 
}

.em-drawer-header { 
    padding: 20px 25px; border-bottom: 1px solid #eee; 
    display: flex; justify-content: space-between; align-items: center; background: #fcfcfc; 
}
.em-drawer-header h3 { margin: 0; font-size: 18px; color: #1e293b; }
.em-close-x { font-size: 32px; background: none; border: none; cursor: pointer; color: #94a3b8; line-height: 1; }
.em-close-x:hover { color: #ef4444; }

.em-drawer-body { padding: 20px 25px; flex: 1; overflow-y: auto; }
.em-form-item { margin-bottom: 18px; }
.em-form-item label { display: block; font-size: 13px; color: #64748b; margin-bottom: 6px; font-weight: 600; }
.em-form-item input, .em-form-item textarea { 
    width: 100%; padding: 10px 12px; border: 1px solid #d1d5db; 
    border-radius: 8px; font-size: 14px; outline: none; transition: 0.2s; box-sizing: border-box;
}
.em-form-item input:focus, .em-form-item textarea:focus { border-color: #818cf8; ring: 2px rgba(129, 140, 248, 0.2); }
.em-form-item textarea { height: 100px; resize: vertical; font-family: inherit; }

.em-drawer-footer { 
    padding: 20px 25px; border-top: 1px solid #eee; 
    display: flex; justify-content: flex-end; gap: 12px; background: #fcfcfc;
}

/* 6. 其他小部件 */
.em-badge { padding: 3px 12px; border-radius: 20px; font-size: 12px; font-weight: bold; }
.em-badge.yes { background: #dcfce7; color: #166534; }
.em-badge.no { background: #fee2e2; color: #991b1b; }

.btn-edit { color: #6366f1; background: none; border: none; cursor: pointer; font-size: 16px; margin-right: 12px; }
.btn-del { color: #f43f5e; background: none; border: none; cursor: pointer; font-size: 16px; }

.em-col-popup {
    display: none; position: absolute; right: 120px; top: 55px; 
    background: white; border-radius: 12px; padding: 10px; width: 220px;
    box-shadow: 0 10px 25px rgba(0,0,0,0.15); z-index: 200; border: 1px solid #e5e7eb;
}
.pop-list { max-height: 350px; overflow-y: auto; }
.pop-list label { display: flex; align-items: center; gap: 10px; padding: 8px; cursor: pointer; border-radius: 6px; font-size: 13px; }
.pop-list label:hover { background: #f1f5f9; }

/* 5级渐变背景色 - 柔和版 */
.cell-expired { background-color: #fecaca !important; color: #b91c1c !important; font-weight: bold; }
.cell-3days   { background-color: #fed7aa !important; color: #c2410c !important; }
.cell-10days  { background-color: #fef08a !important; color: #a16207 !important; }
.cell-20days  { background-color: #fef9c3 !important; color: #854d0e !important; }
.cell-30days  { background-color: #f0fdf4 !important; color: #166534 !important; }
